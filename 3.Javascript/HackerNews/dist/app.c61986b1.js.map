{"version":3,"sources":["app.ts"],"names":[],"mappings":"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","file":"app.c61986b1.js","sourceRoot":"..","sourcesContent":["interface Store{\r\n  currentPage:number;\r\n  feeds:NewsFeed[];\r\n  \r\n}\r\n\r\ninterface News{\r\n  readonly id:number;\r\n  time_ago:string;\r\n  title:string;\r\n  url:string;\r\n  user:string;\r\n  content:string;\r\n}\r\n\r\ninterface NewsFeed extends News {\r\n  comments_count:number;\r\n  points:number; \r\n  read?:boolean;\r\n}\r\n \r\ninterface NewsDetail extends News { \r\n  comments:NewsComment[];\r\n}\r\n\r\ninterface NewsComment extends News{ \r\n  comments:NewsComment[];\r\n  level:number;\r\n}\r\n\r\n\r\nconst container: HTMLElement | null = document.getElementById('root');\r\nconst ajax: XMLHttpRequest= new XMLHttpRequest();\r\nconst NEWS_URL = 'https://api.hnpwa.com/v0/news/1.json';\r\nconst CONTENT_URL = 'https://api.hnpwa.com/v0/item/@id.json';\r\nconst store:Store = {\r\n  currentPage: 1,\r\n  feeds: [],\r\n};\r\n\r\nfunction applyApiMixins(targetClass:any,baseClasses:any[]):void{\r\n  baseClasses.forEach(baseClass=>{\r\n    Object.getOwnPropertyNames(baseClass.prototype).forEach(name=>{\r\n      const descriptor=Object.getOwnPropertyDescriptor(baseClass.prototype, name);\r\n\r\n      if(descriptor){\r\n        Object.defineProperty(targetClass.prototype, name,descriptor);\r\n      }\r\n    });\r\n  });\r\n}\r\nclass Api{\r\n  getRequest<AjaxResponse>(url:string):AjaxResponse{//생성자가없으면url직접 받아줘야\r\n    //this사용 불가로 내부 변수로만듬\r\n    const ajax=new XMLHttpRequest();\r\n    \r\n    ajax.open('GET',url, false);\r\n    ajax.send();\r\n  \r\n    return JSON.parse(ajax.response);\r\n  }\r\n}\r\nclass NewsFeedApi{\r\n  getData():NewsFeed[]{  \r\n   return this.getRequest<NewsFeed[]>(NEWS_URL);\r\n  }  \r\n}\r\n\r\nclass NewsDetailApi{\r\n  getData(id:string):NewsDetail{   \r\n   return this.getRequest<NewsDetail>(CONTENT_URL.replace('@id',id));\r\n  }  \r\n}\r\n\r\ninterface NewsFeedApi extends Api {};\r\ninterface NewsDetailApi extends Api {};\r\n\r\n\r\n\r\n applyApiMixins(NewsFeedApi, [Api]); //A에게 B기능을 추가해준다\r\n applyApiMixins(NewsDetailApi,[Api]);\r\n\r\nfunction makeFeeds(feeds:NewsFeed[]):NewsFeed[] {\r\n  for (let i = 0; i < feeds.length; i++) {\r\n    feeds[i].read = false;\r\n  }\r\n\r\n  return feeds;\r\n}\r\n\r\nfunction updateView(html:string):void{ \r\n  if(container!=null){\r\n    container.innerHTML = html;\r\n    }else{\r\n      console.error('최상위 컨테이너가 없어 UI를 진행하지 못합니다..');\r\n    }\r\n}\r\nfunction newsFeed():void {\r\n  //클래스는 항상 인스턴스를 생성해야\r\n  const api=new NewsFeedApi();\r\n\r\n  let newsFeed:NewsFeed[] = store.feeds;\r\n  const newsList = [];\r\n  let template = `\r\n    <div class=\"bg-gray-600 min-h-screen\">\r\n      <div class=\"bg-white text-xl\">\r\n        <div class=\"mx-auto px-4\">\r\n          <div class=\"flex justify-between items-center py-6\">\r\n            <div class=\"flex justify-start\">\r\n              <h1 class=\"font-extrabold\">Hacker News</h1>\r\n            </div>\r\n            <div class=\"items-center justify-end\">\r\n              <a href=\"#/page/{{__prev_page__}}\" class=\"text-gray-500\">\r\n                Previous\r\n              </a>\r\n              <a href=\"#/page/{{__next_page__}}\" class=\"text-gray-500 ml-4\">\r\n                Next\r\n              </a>\r\n            </div>\r\n          </div> \r\n        </div>\r\n      </div>\r\n      <div class=\"p-4 text-2xl text-gray-700\">\r\n        {{__news_feed__}}        \r\n      </div>\r\n    </div>\r\n  `;\r\n\r\n  if (newsFeed.length === 0) {\r\n    newsFeed = store.feeds = makeFeeds(api.getData());\r\n  }\r\n\r\n  for(let i = (store.currentPage - 1) * 10; i < store.currentPage * 10; i++) {\r\n    newsList.push(`\r\n      <div class=\"p-6 ${newsFeed[i].read ? 'bg-red-500' : 'bg-white'} mt-6 rounded-lg shadow-md transition-colors duration-500 hover:bg-green-100\">\r\n        <div class=\"flex\">\r\n          <div class=\"flex-auto\">\r\n            <a href=\"#/show/${newsFeed[i].id}\">${newsFeed[i].title}</a>  \r\n          </div>\r\n          <div class=\"text-center text-sm\">\r\n            <div class=\"w-10 text-white bg-green-300 rounded-lg px-0 py-2\">${newsFeed[i].comments_count}</div>\r\n          </div>\r\n        </div>\r\n        <div class=\"flex mt-3\">\r\n          <div class=\"grid grid-cols-3 text-sm text-gray-500\">\r\n            <div><i class=\"fas fa-user mr-1\"></i>${newsFeed[i].user}</div>\r\n            <div><i class=\"fas fa-heart mr-1\"></i>${newsFeed[i].points}</div>\r\n            <div><i class=\"far fa-clock mr-1\"></i>${newsFeed[i].time_ago}</div>\r\n          </div>  \r\n        </div>\r\n      </div>    \r\n    `);\r\n  }\r\n\r\n  template = template.replace('{{__news_feed__}}', newsList.join(''));\r\n  template = template.replace('{{__prev_page__}}', String(store.currentPage > 1 ? store.currentPage - 1 : 1));\r\n  template = template.replace('{{__next_page__}}', String(store.currentPage + 1));\r\n  \r\n  updateView(template);\r\n}\r\n\r\nfunction newsDetail():void {\r\n  const id = location.hash.substr(7);\r\n  const api=new NewsDetailApi();\r\n  const newsContent = api.getData(id);\r\n  let template = `\r\n    <div class=\"bg-gray-600 min-h-screen pb-8\">\r\n      <div class=\"bg-white text-xl\">\r\n        <div class=\"mx-auto px-4\">\r\n          <div class=\"flex justify-between items-center py-6\">\r\n            <div class=\"flex justify-start\">\r\n              <h1 class=\"font-extrabold\">Hacker News</h1>\r\n            </div>\r\n            <div class=\"items-center justify-end\">\r\n              <a href=\"#/page/${store.currentPage}\" class=\"text-gray-500\">\r\n                <i class=\"fa fa-times\"></i>\r\n              </a>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"h-full border rounded-xl bg-white m-6 p-4 \">\r\n        <h2>${newsContent.title}</h2>\r\n        <div class=\"text-gray-400 h-20\">\r\n          ${newsContent.content}\r\n        </div>\r\n\r\n        {{__comments__}}\r\n\r\n      </div>\r\n    </div>\r\n  `;\r\n\r\n  for(let i=0; i < store.feeds.length; i++) {\r\n    if (store.feeds[i].id === Number(id)) {\r\n      store.feeds[i].read = true;\r\n      break;\r\n    }\r\n  }\r\n  updateView(template.replace('{{__comments__}}', makeComment(newsContent.comments)));\r\n }\r\n\r\n function makeComment(comments:NewsComment[]) :string {\r\n  const commentString = [];\r\n  \r\n  for(let i = 0; i < comments.length; i++) {\r\n    const comment:NewsComment=comments[i];\r\n    \r\n    commentString.push(`\r\n      <div style=\"padding-left: ${comment.level * 40}px;\" class=\"mt-4\">\r\n        <div class=\"text-gray-400\">\r\n          <i class=\"fa fa-sort-up mr-2\"></i>\r\n          <strong>${comment.user}</strong> ${comment.time_ago}\r\n        </div>\r\n        <p class=\"text-gray-700\">${comment.content}</p>\r\n      </div>      \r\n    `);\r\n\r\n    if (comments[i].comments.length > 0) {\r\n      commentString.push(makeComment(comments[i].comments));\r\n    }\r\n  }\r\n\r\n  return commentString.join('');\r\n}\r\n\r\nfunction router():void {\r\n  const routePath = location.hash;\r\n\r\n  if (routePath === '') {\r\n    newsFeed();\r\n  } else if (routePath.indexOf('#/page/') >= 0) {\r\n    store.currentPage = Number(routePath.substr(7));\r\n    newsFeed();\r\n  } else {\r\n    newsDetail()\r\n  }\r\n}\r\n\r\nwindow.addEventListener('hashchange', router);\r\n\r\nrouter();\r\n"]}